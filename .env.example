# Application environment
NODE_ENV=development # Environment name: development | test | production
PORT=4000 # HTTP port for the API server

# PostgreSQL connection (used to build DATABASE_URL internally)
DB_HOST=localhost # Database host
DB_PORT=5432 # Database port
DB_NAME=appcoran # Database name
DB_USER=postgres # Database user
DB_PASSWORD=postgres # Database password
DB_ADMIN_DATABASE=postgres # Admin DB used to create DB if missing

# Authentication (JWT)
JWT_SECRET=change_me # Secret key used to sign access tokens
JWT_EXPIRES_IN=1h # Access token lifetime (e.g., 1h, 15m)
REFRESH_TOKEN_SECRET=change_me_refresh # Secret for refresh tokens (optional)

# CORS
CORS_ORIGIN=http://localhost:5173 # Allowed frontend origin
PUBLIC_APP_URL=http://localhost:5173 # Frontend base URL for share links
TRUST_PROXY=loopback # Use loopback when behind local reverse proxy

# Uploads
UPLOAD_DIR=./uploads # Where audio files are stored
PROFILE_UPLOAD_DIR=./uploads/profiles # Where profile photos are stored
BASMALA_PATH=./assets/default/basmala_default.mp3 # Path to basmala audio file

# FFmpeg / FFprobe (audio processing)
FFMPEG_REQUIRED=true # If true, server fails when ffmpeg/ffprobe are missing
FFMPEG_PATH=ffmpeg # ffmpeg binary path
FFPROBE_PATH=ffprobe # ffprobe binary path

# Upload limits and rate limiting
MAX_UPLOAD_MB=50 # Max upload size in MB
RATE_LIMIT_WINDOW_MS=60000 # Rate limit window in ms
RATE_LIMIT_MAX=100 # Max requests per window
AUTH_RATE_LIMIT_WINDOW_MS=900000 # Auth rate limit window in ms
AUTH_RATE_LIMIT_MAX=10 # Max auth requests per window

# Database automation
AUTO_MIGRATE=true # Run migrations on startup
AUTO_SEED=true # Seed default admin on startup

# Admin seed account (used when AUTO_SEED=true)
ADMIN_EMAIL=imam@example.com # Default admin email
ADMIN_PASSWORD=ChangeMe123! # Default admin password

# Super admin seed account (optional)
SUPER_ADMIN_EMAIL=superadmin@appcoran.com
SUPER_ADMIN_PASSWORD=cfmlbttjn

# Public registration (disable in production)
ALLOW_PUBLIC_REGISTRATION=false

# Storage behavior
KEEP_ORIGINAL_AUDIO=true # Keep original audio after processing
# Server host binding (0.0.0.0 exposes to LAN)
HOST=0.0.0.0

# Redis / Audio queue
REDIS_URL=redis://localhost:6379
AUDIO_QUEUE_ENABLED=true
AUDIO_QUEUE_CONCURRENCY=2
AUDIO_QUEUE_PREFIX=appcoran
AUDIO_QUEUE_ATTEMPTS=3
AUDIO_QUEUE_BACKOFF_MS=5000
AUDIO_QUEUE_JOB_TIMEOUT_MS=600000
AUDIO_QUEUE_REMOVE_ON_FAIL=false
AUDIO_QUEUE_LOCK_DURATION_MS=600000
AUDIO_QUEUE_STALLED_INTERVAL_MS=30000
AUDIO_QUEUE_MAX_STALLED_COUNT=2
WORKER_PORT=4010

# Async audio processing (queue required)
AUDIO_PROCESSING_ASYNC=true

# Audio encoding
AUDIO_TARGET_BITRATE_KBPS=128
AUDIO_VBR_QUALITY=2
AUDIO_LOUDNORM=true
AUDIO_MAX_DURATION_SECONDS=0

# DigitalOcean Spaces / S3 (optional)
SPACES_ENABLED=false
SPACES_ENDPOINT=https://nyc3.digitaloceanspaces.com
SPACES_REGION=nyc3
SPACES_BUCKET=your-bucket
SPACES_ACCESS_KEY_ID=change_me
SPACES_SECRET_ACCESS_KEY=change_me
SPACES_PUBLIC_BASE_URL=https://your-bucket.nyc3.digitaloceanspaces.com

# Antivirus (ClamAV)
VIRUS_SCAN_ENABLED=false
VIRUS_SCAN_AUTO=true
VIRUS_SCAN_TOOL=clamscan
VIRUS_SCAN_TIMEOUT_MS=60000
